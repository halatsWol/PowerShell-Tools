TOPIC
    About_CredentialHandler

SHORT DESCRIPTION
    Provides a lightweight custom replacement for the built-in
    Get-Credential cmdlet in Windows PowerShell 5.1,
    which may fail to prompt for credentials due to a .NET bug.

LONG DESCRIPTION
    The CredentialHandler module includes the Get-CredentialObject
    function, which securely collects a username and password from the
    user and returns a PSCredential object.

    This module is designed as a workaround for a known bug in
    Windows PowerShell 5.1 (on Windows 10/11, version 22H2 and later).
    In affected environments, calling the built-in Get-Credential
    may fail immediately with an error instead of prompting the user.

    The bug is caused by the .NET Framework WPF-based prompt logic,
    which no longer works reliably in these environments.
    Since .NET Framework is no longer actively maintained, this issue
    will not be fixed (see GitHub issues:
    https://github.com/microsoft/terminal/issues/14119 and
    https://github.com/microsoft/terminal/issues/11847).

    The bug does not occur in:
      - Windows PowerShell started via Windows Terminal
      - PowerShell 7+ (based on .NET Core)

    As an alternative, administrators may enable ConsolePrompting in
    the registry, but this module provides a simple, user-friendly
    fallback without modifying system-wide settings.

    Registry alternative to enable ConsolePrompting:
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\PowerShell\1\ShellIds" `
                         -Name "ConsolePrompting" -Value $true


FUNCTIONS
    Get-CredentialObject
        Prompts the user for credentials and returns a
        System.Management.Automation.PSCredential object.

        PARAMETERS
            -UserName <String>
                The username to use for the credential object.
                If not specified, the function will prompt for it.

        EXAMPLES
            Example 1: Prompt for both username and password
                PS C:\> Get-CredentialObject

            Example 2: Prompt only for password (username is prefilled)
                PS C:\> Get-CredentialObject -UserName admin

SEE ALSO
    Get-Help
    Get-Command
    Get-Member
    Get-Credential
    Import-Module
    Export-ModuleMember


AUTHOR
    Author:  Wolfram Halatschek
    E-Mail:  dev@kMarflow.com
    Created: 2025-08-21


COPYRIGHT
    Â© 2025 Wolfram Halatschek. All rights reserved.